import{a as N}from"./chunk-6XMCUX5C.js";import{C as H,D as G,E as J,M as K,R as Q,b as F,e as V,f as D,g as L,h as T,i as P,l as O,n as k,o as U,u as z,v as j,x as B,y as W,z as q}from"./chunk-5MEDXVZL.js";import{$a as A,Aa as o,Ab as E,Ba as r,Ca as v,Ib as I,Ja as C,La as u,P as p,Q as d,Wa as S,Za as s,ab as R,bb as w,cb as y,ea as a,la as c,oa as b,ta as _,wb as x,y as M,za as m}from"./chunk-KZ4A25DD.js";var f={errorCode:20,message:""};var Y=["class","component"];function Z(l,i){l&1&&v(0,"app-spinner",9),l&2&&m("size",40)}var X=class l{constructor(i,e,t){this._authService=i;this.router=e;this.dialog=t}email="";password="";loginValidate=!1;loading=!1;errorMessage=f;handleResponse(i){this.loading=!0,i.pipe(M(()=>this.loading=!1)).subscribe({next:e=>{e.errorCode?this.errorMessage=e:e.success?(this.errorMessage={errorCode:0,message:`Email ${e.email} registrado con \xE9xito. Redirigiendo...`},localStorage.setItem("email",this.email),this.router.navigate(["/dashboard"])):e.message?(this.errorMessage={errorCode:0,message:e.message},this.onNotification(this.errorMessage.message??"Iniciando Session"),localStorage.setItem("email",this.email),this.router.navigate(["/dashboard"])):this.errorMessage=f},error:e=>{this.errorMessage=e,this.onNotification(this.errorMessage.message??"Problemas con el inicio de session")}})}onLogin(){this.handleResponse(this._authService.postLogin(this.email))}onRegister(){this.handleResponse(this._authService.signUp(this.email))}onNotification(i){this.dialog.open(Q,{width:"300px",data:{message:i}})}static \u0275fac=function(e){return new(e||l)(c(N),c(I),c(K))};static \u0275cmp=b({type:l,selectors:[["app-auth",8,"component"]],attrs:Y,decls:17,vars:5,consts:[["loginForm","ngForm"],[1,"login-container"],["appearance","fill",1,"full-width"],["matInput","","type","email","name","email","required","",3,"ngModelChange","ngModel"],[1,"error-text",2,"color","red"],["color","#e74c3c",3,"size",4,"ngIf"],[1,"button-group"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["mat-raised-button","","color","accent","type","button",3,"click","disabled"],["color","#e74c3c",3,"size"]],template:function(e,t){if(e&1){let n=C();o(0,"div",1)(1,"h2"),s(2,"Login"),r(),o(3,"form",null,0)(5,"mat-form-field",2)(6,"mat-label"),s(7,"Email"),r(),o(8,"input",3),y("ngModelChange",function(g){return p(n),w(t.email,g)||(t.email=g),d(g)}),r()(),o(9,"span",4),s(10),r(),_(11,Z,1,1,"app-spinner",5),o(12,"div",6)(13,"button",7),u("click",function(){return p(n),d(t.onLogin())}),s(14," Login "),r(),o(15,"button",8),u("click",function(){return p(n),d(t.onRegister())}),s(16," Registro "),r()()()()}if(e&2){let n=S(4);a(8),R("ngModel",t.email),a(2),A(" ",t.errorMessage.message," "),a(),m("ngIf",t.loading),a(2),m("disabled",!n.form.valid||t.loading),a(2),m("disabled",!n.form.valid||t.loading||(t.errorMessage.errorCode??0)!==40)}},dependencies:[E,x,U,P,F,V,D,O,k,T,L,q,W,j,z,B,G,H,J],styles:[".login-container[_ngcontent-%COMP%]{max-width:400px;margin:100px auto;padding:30px;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 10px #0000001a}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}"]})};export{X as AuthComponent};
